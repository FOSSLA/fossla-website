---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";

const statusColors: Record<string, string> = {
  Active: "bg-primary/20 text-primary border-primary/30",
  "In Development": "bg-blue-500/20 text-blue-400 border-blue-500/30",
  Planning: "bg-yellow-500/20 text-yellow-400 border-yellow-500/30"
};

const projects = (await getCollection("projects")).sort((a, b) => a.data.title.localeCompare(b.data.title));
---
<BaseLayout title="FOSS LA Projects" description="Explore open source projects solving Ladakh's challenges.">
  <section class="container mx-auto px-4 pt-24 pb-20">
    <div class="mx-auto mb-16 max-w-4xl text-center">
      <h1 class="mb-6 text-4xl font-bold md:text-5xl">
        Our <span class="text-primary">Projects</span>
      </h1>
      <p class="text-xl text-muted-foreground">
        Explore the open source projects we're building to solve local challenges and contribute to the global FOSS ecosystem.
      </p>
    </div>

    <div class="mx-auto mb-16 max-w-4xl rounded border border-primary/30 bg-primary/5 p-8 text-center">
      <Icon name="lucide:code-2" class="mx-auto mb-4 h-12 w-12 text-primary" />
      <h3 class="mb-2 text-xl font-bold">Have a Project Idea?</h3>
      <p class="mb-4 text-muted-foreground">We're always looking for new projects that can benefit our community.</p>
      <a href="mailto:projects@fossla.org" class="rounded border border-primary bg-primary px-6 py-2 font-semibold text-primary-foreground">
        Propose a Project
      </a>
    </div>

    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {projects.map((project) => (
        <article class="flex flex-col rounded border border-border bg-card/40 p-6 transition hover:border-primary/50">
          <div class="mb-6 flex items-start justify-between text-xs">
            <span class={`rounded border px-2 py-1 font-semibold ${statusColors[project.data.status]}`}>
              {project.data.status}
            </span>
            <span class="text-muted-foreground">{project.data.contributors} contributors</span>
          </div>
          <h3 class="mb-3 text-2xl font-semibold text-foreground">
            {project.data.title}
          </h3>
          <p class="mb-4 flex-1 text-sm text-muted-foreground">{project.data.description}</p>
          <div class="mb-4 flex flex-wrap gap-2 text-xs">
            {project.data.techStack.map((tech) => (
              <span class="rounded bg-secondary px-2 py-1 text-foreground">{tech}</span>
            ))}
          </div>
          <div class="flex gap-2 text-sm">
            <a
              href={project.data.github}
              class="flex-1 rounded border border-border px-4 py-2 text-center font-semibold hover:border-primary"
              target="_blank"
              rel="noopener noreferrer"
            >
              GitHub
            </a>
            <a href={project.data.github} class="rounded border border-border px-3 py-2 hover:border-primary" target="_blank" rel="noopener noreferrer">
              <Icon name="lucide:external-link" class="h-4 w-4" />
            </a>
          </div>
        </article>
      ))}
    </div>
  </section>
</BaseLayout>
